# 预处理命令

程序设计语言的预处理的概念：在编译之前进行的处理，预处理命令以符号「**#**」开头。

C 语言的预处理主要有三个方面的内容： 

1. 宏定义
2. 文件包含 
3. 条件编译

## 宏定义

宏定义（Macro）又称为宏代换、宏替换，简称「宏」。在预处理（也叫[预编译](https://baike.baidu.com/item/%E9%A2%84%E7%BC%96%E8%AF%91)）时：将宏名替换为文本，这个文本可以是字符串、代码等。预处理工作也叫做宏展开。

宏定义格式：`#define 标识符 文本`

例如：`#define PI 3.1415926`，这个宏定义把程序中全部的「PI」标识符换成「3.1415926」。

> ⚠️ **注意**
> 
> 1. 宏名一般用大写。
> 2. 使用宏可提高程序的通用性和易读性，便于修改，减少不一致性和输入错误。
> 3. 可以用 `#undef` 命令终止宏定义的作用域
> 4. 宏定义可以嵌套。

## 文件包含

文件包含指一个源文件[^源文件]可以将另一个源文件的全部内容包含进来。该命令的作用是在预编译时，将指定源文件的内容复制到当前文件中。

[^源文件]: 源文件：一般指用汇编语言或高级语言写出来的代码保存为文件后的结果，源文件是相对目标文件和可执行文件而言的。

文件包含格式：`#include "文件名"` 或 `#include <文件名>`

这两格式的区别在于：

- 使用双引号(`""`)

    系统首先到当前目录下查找被包含的文件，如果没找到，再到系统指定的「包含文件目录」（由用户在配置环境时设置）去找。
    
- 使用尖括号(`<>`)

    直接到系统指定的「包含文件目录」去查找。

在 Objective-C 中使用 #import 指令来包含结构体，#import 指令是针对 #include 的改进版本，#import 确保引用的文件只会被引用一次，这样就不会引起交叉编译的问题。因为在 Objective-C 中会存在 C/C++ 和 Objective-C 混编，如果使用 #include 引入头文件，会导致交叉编译。

实际开发中使用 `#import<>` 引入某个框架中的头文件，而 `#import""` 用来引入自定义头文件。

## 条件编译

一般情况下，C 语言源程序中的每一行代码，都要参加编译。但有时候出于对程序代码优化的考虑，希望只对其中一部分内容进行编译。此时就需要在程序中加上条件，让编译器只对满足条件的代码进行编译，将不满足条件的代码舍弃，这就是条件编译。

条件编译的几种格式：

- if 格式

    ```C
    #if 表达式
        语句 A
    #else 
        语句 B
    #endif
    ```
    
    当「表达式」的值为真时，编译语句 A，否则编译语句 B。其中，#else 及 语句B 可有可无。
    
- ifdef 格式

    ```C
    #ifdef 标识符
        语句 A
    #else
        语句 B
    #endif
    ```
    
    当「标识符」已被定义时（用 #define 定义），编译语句 A，否则编译语句 B。其中 #else 和语句 B 可有可无。
    
- ifndef 格式
    
    ```C
    #ifndef 标识符
        语句 A
    #else
        语句 B
    #endif
    ```

    该格式功能与 ifdef 相反。当「标识符」没有被定义时（用 #define 定义），编译语句 A，否则编译语句 B。其中 #else 和语句 B 可有可无。